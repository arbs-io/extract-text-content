import*as s from"fs";import m from"pdf-parse";import i from"mammoth";import{NodeHtmlMarkdown as f}from"node-html-markdown";async function E({filepath:r,filetype:e}){let t=await new Promise((n,c)=>{let o=s.createReadStream(r),x=[];o.on("data",a=>{x.push(a)}),o.on("error",a=>{c(a)}),o.on("end",()=>{let a=new Uint8Array(Buffer.concat(x));n(a)})});return await p({bufferArray:t,filetype:e})}async function p({bufferArray:r,filetype:e}){switch(e){case"application/pdf":{let t=Buffer.from(r.buffer),n=await m(t);return{mimeType:e,content:n.text}}case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{let t=Buffer.from(r.buffer),n=await i.extractRawText({buffer:t});return{mimeType:e,content:n.value}}case"text/markdown":case"text/csv":case"text/html":{let t=new TextDecoder().decode(r);return{mimeType:e,content:f.translate(t)}}case"text/plain":return{mimeType:e,content:new TextDecoder().decode(r)};default:throw new Error("Unsupported file type")}}export{p as extractTextFromBuffer,E as extractTextFromFile};
